<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Зенит | Личный кабинет</title>
    <link rel="icon" type="image/png" size="512x512" href="../img/icon-round.png">
    <link rel="stylesheet" href="../css/sotr.css">
    <script src="https://unpkg.com/@vkid/sdk@latest/dist-sdk/umd/index.js"></script>
    <script src="../scripts/index.js"></script>
</head>
<body>
    <header>
        <a href="../index.html"><img class="name" src="../img/ZEnit.png" alt="Иконка" href="../index.html"></a>
        <nav class="navigation">
            <a class="a" href="#grafik">Запись</a>
            <a class="a" href="#ustav">Устав</a>
            <a class="a" href="#talk">Беседы</a>
            <a class="a" href="../index.html">Расписание</a>
        </nav>
    </header>
    <main>
        <section class="lk">
            <div class="lk_name">
                <h2 class="lk_name-text">
                    Добро пожаловать в личный кабинет &#128075;
                </h2>
            </div>
            <div class="info" id="info">
                <h3 id="fname" class="fname">
                    Пока нет информации о тебе &#129300;
                </h3>
                <h3 id="rank" class="rank">
                    Информации о ранге нет :(
                </h3>
            </div>
        </section>
        <section>
            <div class="ut_name">
                <h2 class="lk_name-text">
                    Запись &#128214;
                </h2>
            </div>
            <div class="info">
                <div id="disactive">
                    <h3 class="text">
                        Упс... У тебя нету доступа к этому &#128164;
                    </h3>
                </div>
                <div class="disabled" id="grafik">
                    <div class="zapis">
                        <div class="text">
                            <h3>
                                Здесь ты можешь записаться на график. Вводи данные в формате: Маршрут/Время/Ник/Дата
                            </h3>
                        </div>
                    </div>
                    <form class="rec" name="submit-to-google-sheet">
                        <input name="МТ" class="mt" id="mt" placeholder="11" required autocomplete="off" minlength="2" maxlength="3" pattern="11|32|45|70|211|212|213" title="Пожалуйста, укажи корректный маршрут">
                        <input name="Время выхода" class="time" id="time" type="time" placeholder="14:20" required autocomplete="off" title="Пожалуйста, укажи корректное время">
                        <input name="Никнейм" class="nickname" id="nickname" type="text" placeholder="Ivan Ivanov" required autocomplete="off" minlength="8" title="Пожалуйста, введи никнейм">
                        <input name="Дата" class="date" id="nickname" type="date" placeholder="01.01.2024" required autocomplete="off">
                        <button class="bt" type="submit">Записаться</button>
                    </form>
                    <div class="success">
                        <h3 class="succes-text">
                                
                        </h3>
                        <h3 class="error-text">

                        </h3>
                    </div>
                    <div class="zapis">
                        <div class="text-2">
                            <h3>
                                Вылетело? Не успел? Для отмены отправь запись на маршрут еще раз с указанием "[Ник], ОТМЕНА" в поле "Никнейм"
                            </h3>
                        </div>
                    </div> 
                </div>
            </div>
        </section>
        <section class="ustav" id="ustav">
            <div class="ut_name">
                <h2 class="lk_name-text">
                    Устав &#128214;
                </h2>
            </div>
            <div class="info">
                <form action="https://vk.com/@zenit_s1-ustav-chatp-ooo-zenit">
                    <button class="buy">Кликни на меня</button>
                </form>
            </div>
        </section>
        <section class="talk" id="talk">
            <div class="ut_name">
                <h2 class="lk_name-text">
                    Трудоустройство &#128172;
                </h2>
            </div>
            <div class="tuvo" id="tuvo">
                <div class="text-tuvo">
                    <h3 class="prigl">
                        Приглашаем на работу водителей автобуса!
                    </h3>
                    <div class="treb">
                        От тебя нужно:
                    </div>
                    <ul class="spisok">
                        <li>Перевозка пассажиров</li>
                        <li>Пройти стажировку</li>                     
                        <li>Соблюдать устав компании</li>
                    </ul>
                    <form action="https://vk.com/app5619682_-210319269#595005">
                        <button class="btn-tuvo" type="submit">Трудоустроиться</button>
                    </form>
                </div>
                <img src="../img/VA30uLMQv80.jpg" alt="Трудоустройство" class="img-tuvo">
            </div>
        </section>
    </main>
    <footer>
        <a class="a" href="../index.html"><h3>На главную</h3></a>
    </footer>
    <script src="../scripts/auth.js" defer></script>
    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzopn8kCPq3rFSh9F7FgqzqqYPCPmS8UvDmu3-_wGB5AcoHyyOrYBYm8Hl5ht9NIsxE/exec'
        const form = document.forms['submit-to-google-sheet']
        let successNode = document.querySelector(`.succes-text`)
        let timeInput = document.querySelector(`.time`)
        let mtInput = document.querySelector(`.mt`)
        let errorNode = document.querySelector('.error-text')
      
        form.addEventListener('submit', e => {
          e.preventDefault()
          fetch(scriptURL, { method: 'POST', body: new FormData(form)})
            .then(response => successNode.innerHTML = `Вы успешно записаны`, timeInput.value = ``, mtInput.value = ``)
            .catch(error => errorNode.innerHTML = 'Хм... Не смог Вас записать. Повторите попытку!')
        })
      </script>
</body>
</html>